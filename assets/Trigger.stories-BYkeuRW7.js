import{L as O,u as E,V as X}from"./index-TSpHFyo_.js";import{j as e}from"./jsx-runtime-QvtbNqby.js";import{u as Z}from"./index-yfVukVkJ.js";import{u as v}from"./usePrefix-CXWdRn9x.js";import{_ as T,u as ee,m as re,E as se}from"./floating-ui.dom.mjs-PU7UL9dJ.js";import{c as R}from"./index-CjLpwf8N.js";import{P as a}from"./index-kGlasm3i.js";import{r as D,R as l}from"./index-BjzEU6Zr.js";import{T as V,d as te}from"./deprecate-GNGtdTso.js";import{g as ae}from"./bucket-2-C9DXCKPV.js";import{V as F}from"./ViewYAML-ReMqin4P.js";import{T as K}from"./Table-D1X7MWr6.js";import"./constants-PT-Qtcqm.js";import"./Link-ChQlTR16.js";import"./index-B22udTS1.js";import"./Icon-CpyVU44g.js";import"./index-CfoIBI3E.js";import"./Button-xjCpe_BM.js";import"./index-Da0at1PC.js";import"./Tooltip-BJBVfZ_G.js";import"./events-OVwOsPzJ.js";import"./index-Dc4QqC9m.js";import"./bucket-0-C5s-C6Km.js";import"./requiredIfGivenPropIsTruthy-CU7JwK8h.js";import"./mergeRefs-CTUecegF.js";import"./index-lRp1do-S.js";import"./index-55dkfs-I.js";import"./bucket-12-CMgbqDR8.js";import"./noopFn-g4z370MD.js";import"./Search-7e9e9RA9.js";import"./FormContext-IWjAIOZU.js";import"./bucket-3-Dq7FRXBG.js";const B=D.createContext({disabled:!1}),oe=i=>{let{disabled:n,children:s}=i;return l.createElement(B.Provider,{value:{disabled:n}},s)};function L(i){let{align:n="end",children:s,className:c,disabled:u=!1,isFlush:d=!1,ordered:x=!1,size:g,...N}=i;const m=v(),r=R(`${m}--accordion`,c,{[`${m}--accordion--${n}`]:n,[`${m}--accordion--${g}`]:g,[`${m}--layout--size-${g}`]:g,[`${m}--accordion--flush`]:d&&n!=="start"}),p=x?"ol":"ul";return l.createElement(oe,{disabled:u},l.createElement(p,T({className:r},N),s))}L.propTypes={align:a.oneOf(["start","end"]),children:a.node,className:a.string,disabled:a.bool,isFlush:a.bool,ordered:a.bool,size:a.oneOf(["sm","md","lg"])};const ne=i=>l.createElement("button",T({type:"button"},i));function P(i){let{children:n,className:s="",open:c=!1,onHeadingClick:u,renderExpando:d=ne,renderToggle:x,title:g="title",disabled:N,handleAnimationEnd:m,...r}=i;const[p,h]=D.useState(c),[y,M]=D.useState(c),_=D.useContext(B),t=typeof N=="boolean"?N:_.disabled,j=ee("accordion-item"),o=v(),b=R({[`${o}--accordion__item`]:!0,[`${o}--accordion__item--active`]:p&&!t,[`${o}--accordion__item--disabled`]:t,[s]:!!s}),q=x||d,U=l.useCallback(k=>{k&&p&&(k.style.maxBlockSize="")},[p]);c!==y&&(h(c),M(c));function Y(k){const A=!p;h(A),u&&u({isOpen:A,event:k})}function J(k){p&&re(k,se)&&h(!1)}function Q(k){m&&m(k)}return l.createElement("li",T({className:b},r),l.createElement(q,{disabled:t,"aria-controls":j,"aria-expanded":p,className:`${o}--accordion__heading`,onClick:Y,onKeyDown:J,type:"button"},l.createElement(ae,{className:`${o}--accordion__arrow`}),l.createElement(V,{as:"div",className:`${o}--accordion__title`},g)),l.createElement("div",{ref:U,hidden:!p,className:`${o}--accordion__wrapper`,onTransitionEnd:Q},l.createElement("div",{id:j,className:`${o}--accordion__content`},n)))}P.propTypes={children:a.node,className:a.string,disabled:a.bool,onClick:a.func,onHeadingClick:a.func,open:a.bool,renderExpando:te(a.func),renderToggle:a.func,title:a.node};function z(i){let{className:n,children:s,...c}=i;const u=v(),d=R(`${u}--list__item`,n);return l.createElement(V,T({as:"li",className:d},c),s)}z.propTypes={children:a.node,className:a.string};function W(i){let{className:n,nested:s=!1,isExpressive:c=!1,...u}=i;const d=v(),x=R(`${d}--list--unordered`,n,{[`${d}--list--nested`]:s,[`${d}--list--expressive`]:c});return l.createElement("ul",T({className:x},u))}W.propTypes={children:a.node,className:a.string,isExpressive:a.bool,nested:a.bool};const G=({namespace:i,trigger:n})=>{const s=Z(),c=v(),u=[{key:"name",header:s.formatMessage({id:"dashboard.tableHeader.name",defaultMessage:"Name"})},{key:"value",header:s.formatMessage({id:"dashboard.tableHeader.value",defaultMessage:"Value"})}],{bindings:d,interceptors:x,template:g}=n.spec||n,N=g.ref||g.name,m=n.name;return e.jsxs("div",{children:[m&&e.jsxs("h3",{children:["Trigger: ",m]}),e.jsxs("div",{className:"tkn--trigger-details",children:[d&&d.length!==0&&e.jsxs("div",{className:"tkn--trigger-resourcelinks",children:[e.jsx("span",{className:"tkn--trigger-resourcekind",children:s.formatMessage({id:"dashboard.triggerDetails.triggerBindings",defaultMessage:"TriggerBindings:"})}),e.jsx(W,{children:d.map(r=>e.jsx(z,{children:r.ref?e.jsx(O,{className:"tkn--trigger-resourcelink",to:r.kind==="ClusterTriggerBinding"?E.clusterTriggerBindings.byName({name:r.ref}):E.triggerBindings.byName({name:r.ref,namespace:i}),children:e.jsx("span",{title:r.ref,children:r.ref})}):e.jsx(F,{dark:!0,resource:r})},r.ref||r.name))})]}),e.jsxs("div",{className:"tkn--trigger-resourcelinks",children:[e.jsx("span",{className:"tkn--trigger-resourcekind",children:s.formatMessage({id:"dashboard.triggerDetails.triggerTemplate",defaultMessage:"TriggerTemplate:"})}),g.spec?e.jsx(F,{dark:!0,resource:g}):e.jsx(O,{className:"tkn--trigger-resourcelink",to:E.triggerTemplates.byName({name:N,namespace:i}),children:e.jsx("span",{title:N,children:N})})]})]}),x&&x.length!==0&&e.jsxs("div",{className:"tkn--trigger-interceptors",children:[e.jsx("span",{className:"tkn--trigger-resourcekind",children:s.formatMessage({id:"dashboard.triggerDetails.interceptors",defaultMessage:"Interceptors:"})}),e.jsx(L,{className:"tkn--trigger-interceptors-accordion",title:"Interceptors",children:x.map((r,p)=>{let h,y;const M=s.formatMessage({id:"dashboard.triggerDetails.interceptorNamespace",defaultMessage:"Namespace:"}),_=s.formatMessage({id:"dashboard.triggerDetails.interceptorName",defaultMessage:"Name:"});if(r.webhook){if(!r.webhook.objectRef)return null;h="Webhook";let t=[];r.webhook.header&&(t=r.webhook.header.map(o=>{const b={id:o.name,name:o.name,value:o.value};return Array.isArray(o.value)&&(b.value=o.value.join(", ")),b}));const j=s.formatMessage({id:"dashboard.triggerDetails.webhookInterceptorService",defaultMessage:"Service:"});y=e.jsxs(e.Fragment,{children:[e.jsx("p",{children:j}),e.jsxs("div",{className:"tkn--trigger-interceptor-service-details",children:[e.jsxs("p",{children:[e.jsx("span",{children:_}),r.webhook.objectRef.name]}),r.webhook.objectRef.namespace&&e.jsxs("p",{children:[e.jsx("span",{children:M}),r.webhook.objectRef.namespace]})]}),t.length!==0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:s.formatMessage({id:"dashboard.triggerDetails.interceptorHeader",defaultMessage:"Header:"})}),e.jsx(K,{headers:u,rows:t,size:"sm",emptyTextAllNamespaces:s.formatMessage({id:"dashboard.trigger.noHeaders",defaultMessage:"No headers found for this interceptor."}),emptyTextSelectedNamespace:s.formatMessage({id:"dashboard.trigger.noHeaders",defaultMessage:"No headers found for this interceptor."}),isSortable:!1})]})]})}else if(r.github||r.gitlab){let t;r.github?(h="GitHub",t=r.github):(h="GitLab",t=r.gitlab);const j=t.eventTypes?.join(", "),o=s.formatMessage({id:"dashboard.triggerDetails.webhookInterceptorSecret",defaultMessage:"Secret:"}),b=s.formatMessage({id:"dashboard.triggerDetails.webhookInterceptorSecretKey",defaultMessage:"Key:"});y=e.jsxs(e.Fragment,{children:[t.secretRef&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:o}),e.jsxs("div",{className:"tkn--trigger-interceptor-secret-details",children:[e.jsxs("p",{children:[_," ",t.secretRef.secretName]}),e.jsxs("p",{children:[b," ",t.secretRef.secretKey]}),t.secretRef.namespace&&e.jsxs("p",{children:[M," ",t.secretRef.namespace]})]})]}),e.jsxs("p",{children:["Event Types: ",j]})]})}else if(r.cel){h="CEL";const t=[{key:"key",header:s.formatMessage({id:"dashboard.tableHeader.key",defaultMessage:"Key"})},{key:"expression",header:s.formatMessage({id:"dashboard.tableHeader.expression",defaultMessage:"Expression"})}],o=(r.cel.overlays||[]).map(b=>({id:b.key,key:b.key,expression:b.expression}));y=e.jsxs(e.Fragment,{children:[r.cel.filter&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:s.formatMessage({id:"dashboard.triggerDetails.celInterceptorFilter",defaultMessage:"Filter:"})}),e.jsx("code",{className:`${c}--snippet--multi tkn--trigger-interceptor-cel-filter`,children:r.cel.filter})]}),e.jsx("p",{children:s.formatMessage({id:"dashboard.triggerDetails.celInterceptorOverlays",defaultMessage:"Overlays:"})}),e.jsx(K,{headers:t,rows:o,size:"sm",isSortable:!1,emptyTextAllNamespaces:s.formatMessage({id:"dashboard.trigger.noOverlays",defaultMessage:"No overlays found for this interceptor."}),emptyTextSelectedNamespace:s.formatMessage({id:"dashboard.trigger.noOverlays",defaultMessage:"No overlays found for this interceptor."})})]})}else if(r.ref){h="ClusterInterceptor";const t=r.ref.name;y=e.jsx(O,{to:E.clusterInterceptors.byName({name:t}),title:t,children:t})}else return null;const H=s.formatMessage({id:"dashboard.triggerDetails.interceptorTitle",defaultMessage:"{interceptorNumber}. ({interceptorType}) {interceptorName}"},{interceptorNumber:p+1,interceptorType:h,interceptorName:""});return e.jsx(P,{title:H,children:y},H)})})]})]})};G.__docgenInfo={description:"",methods:[],displayName:"Trigger"};const f={namespace:"default",trigger:{name:"my-trigger",bindings:[{ref:"triggerbinding0"},{ref:"triggerbinding1"},{ref:"triggerbinding2"},{name:"triggerbinding3",value:"$(body.head_commit_id)"}],template:{ref:"triggertemplate"},interceptors:[{webhook:{header:[{name:"header0",value:"value0"},{name:"header1",value:["value1-0","value1-1","value1-2"]}],objectRef:{apiVersion:"v1",kind:"Service",name:"interceptor-service0",namespace:"foo"}}},{github:{secretRef:{secretName:"github-secret",secretKey:"secret"},eventTypes:["push","pull_request"]}},{gitlab:{secretRef:{secretName:"gitlab-secret",secretKey:"secret",namespace:"foo"},eventTypes:["Push Hook"]}},{cel:{filter:"body.matches('foo', 'bar')"}}]}},Ke={component:G,decorators:[X()],title:"Trigger"},I={args:f},w={args:{...f,trigger:{...f.trigger,name:void 0}}},$={args:{...f,trigger:{...f.trigger,bindings:void 0}}},S={args:{...f,trigger:{...f.trigger,interceptors:void 0}}},C={args:{...f,trigger:{...f.trigger,interceptors:[{...f.trigger.interceptors[0],webhook:{...f.trigger.interceptors[0].webhook,header:void 0}}]}}};I.parameters={...I.parameters,docs:{...I.parameters?.docs,source:{originalSource:`{
  args: props
}`,...I.parameters?.docs?.source}}};w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:`{
  args: {
    ...props,
    trigger: {
      ...props.trigger,
      name: undefined
    }
  }
}`,...w.parameters?.docs?.source}}};$.parameters={...$.parameters,docs:{...$.parameters?.docs,source:{originalSource:`{
  args: {
    ...props,
    trigger: {
      ...props.trigger,
      bindings: undefined
    }
  }
}`,...$.parameters?.docs?.source}}};S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:`{
  args: {
    ...props,
    trigger: {
      ...props.trigger,
      interceptors: undefined
    }
  }
}`,...S.parameters?.docs?.source}}};C.parameters={...C.parameters,docs:{...C.parameters?.docs,source:{originalSource:`{
  args: {
    ...props,
    trigger: {
      ...props.trigger,
      interceptors: [{
        ...props.trigger.interceptors[0],
        webhook: {
          ...props.trigger.interceptors[0].webhook,
          header: undefined
        }
      }]
    }
  }
}`,...C.parameters?.docs?.source}}};const Ve=["Default","NoName","NoBindings","NoInterceptors","NoHeadersInWebhookInterceptor"];export{I as Default,$ as NoBindings,C as NoHeadersInWebhookInterceptor,S as NoInterceptors,w as NoName,Ve as __namedExportsOrder,Ke as default};
