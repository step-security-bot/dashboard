import{j as i}from"./jsx-runtime-QvtbNqby.js";import{a as x}from"./chunk-D5ZWXAHU-5jmZk1IN.js";import{R as u,r as g}from"./index-BjzEU6Zr.js";import{u as D}from"./index-yfVukVkJ.js";import"./usePrefix-CXWdRn9x.js";import{B as c}from"./Button-xjCpe_BM.js";import{P as V,p as A,a as $,t as B,b as N}from"./tasks-Dl2QYHPS.js";import{I as E}from"./Icon-CpyVU44g.js";import{Z as L,c as X}from"./bucket-18-ByJs4WER.js";import"./v4-CQkTLCs1.js";import"./floating-ui.dom.mjs-PU7UL9dJ.js";import"./index-B22udTS1.js";import"./index-kGlasm3i.js";import"./index-Da0at1PC.js";import"./index-CjLpwf8N.js";import"./Tooltip-BJBVfZ_G.js";import"./events-OVwOsPzJ.js";import"./index-CfoIBI3E.js";import"./Graph-C1o-5bRe.js";import"./path-C2yqBsjs.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./bucket-3-Dq7FRXBG.js";import"./bucket-17-BNnKjYXl.js";import"./bucket-2-C9DXCKPV.js";var y;const Y=u.forwardRef(function(e,n){let{children:o,size:r=16,...s}=e;return u.createElement(E,{width:r,height:r,ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",...s},y||(y=u.createElement("path",{d:"M23,28a1,1,0,0,1-.71-.29l-6.13-6.14-3.33,5a1,1,0,0,1-1,.44,1,1,0,0,1-.81-.7l-6-20A1,1,0,0,1,6.29,5l20,6a1,1,0,0,1,.7.81,1,1,0,0,1-.44,1l-5,3.33,6.14,6.13a1,1,0,0,1,0,1.42l-4,4A1,1,0,0,1,23,28Zm0-2.41L25.59,23l-7.16-7.15,5.25-3.5L7.49,7.49l4.86,16.19,3.5-5.25Z"})),o)});var k;const F=u.forwardRef(function(e,n){let{children:o,size:r=16,...s}=e;return u.createElement(E,{width:r,height:r,ref:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",...s},k||(k=u.createElement("path",{d:"M25 11L23.59 12.41 26.17 15 17 15 17 5.83 19.59 8.41 21 7 16 2 11 7 12.41 8.41 15 5.83 15 15 5.83 15 8.41 12.41 7 11 2 16 7 21 8.41 19.59 5.83 17 15 17 15 26.17 12.41 23.59 11 25 16 30 21 25 19.59 23.59 17 26.17 17 17 26.17 17 23.59 19.59 25 21 30 16 25 11z"})),o)});var v=function(){function t(n){var o=n.x,r=o===void 0?0:o,s=n.y,a=s===void 0?0:s;this.x=0,this.y=0,this.x=r,this.y=a}var e=t.prototype;return e.value=function(){return{x:this.x,y:this.y}},e.toArray=function(){return[this.x,this.y]},t}();function U(t){return!!t&&t instanceof Element}function W(t){return!!t&&(t instanceof SVGElement||"ownerSVGElement"in t)}function q(t){return!!t&&"createSVGPoint"in t}function H(t){return!!t&&"getScreenCTM"in t}function J(t){return!!t&&"changedTouches"in t}function K(t){return!!t&&"clientX"in t}function Q(t){return!!t&&(t instanceof Event||"nativeEvent"in t&&t.nativeEvent instanceof Event)}function p(){return p=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},p.apply(this,arguments)}var h={x:0,y:0};function tt(t){if(!t)return p({},h);if(J(t))return t.changedTouches.length>0?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:p({},h);if(K(t))return{x:t.clientX,y:t.clientY};var e=t?.target,n=e&&"getBoundingClientRect"in e?e.getBoundingClientRect():null;return n?{x:n.x+n.width/2,y:n.y+n.height/2}:p({},h)}function S(t,e){if(!t||!e)return null;var n=tt(e),o=W(t)?t.ownerSVGElement:t,r=H(o)?o.getScreenCTM():null;if(q(o)&&r){var s=o.createSVGPoint();return s.x=n.x,s.y=n.y,s=s.matrixTransform(r.inverse()),new v({x:s.x,y:s.y})}var a=t.getBoundingClientRect();return new v({x:n.x-a.left-t.clientLeft,y:n.y-a.top-t.clientTop})}function b(t,e){if(U(t)&&e)return S(t,e);if(Q(t)){var n=t,o=n.target;if(o)return S(o,n)}return null}const C={dragging:!1,scale:1,translate:{x:0,y:0}};class M extends g.Component{state=C;reset=()=>{this.setState(C)};center=()=>{this.setState({translate:{x:0,y:0}})};zoomIn=()=>{const{scale:e}=this.state;this.setZoom(e*1.25)};zoomOut=()=>{const{scale:e}=this.state;this.setZoom(e*.8)};zoomScroll=e=>{e.preventDefault(),e.deltaY>0?this.zoomIn():this.zoomOut()};setZoom=e=>{const{maxZoom:n,minZoom:o}=this.props,r=Math.min(Math.max(o,e),n);this.setState({scale:r})};dragStart=e=>{this.setState({dragging:!0}),this.startPoint=b(this.props.svg(),e),this.startTranslate=this.state.translate};dragEnd=()=>{this.setState({dragging:!1})};dragMove=e=>{if(!this.state.dragging)return;const n=b(this.props.svg(),e),o=n.x-this.startPoint.x,r=n.y-this.startPoint.y;this.setState(s=>({translate:{x:this.startTranslate.x+o/s.scale,y:this.startTranslate.y+r/s.scale}}))};render(){const{width:e,height:n,children:o}=this.props,{translate:r,scale:s}=this.state,a={x:e/2,y:n/2},m={x:r.x*s+a.x-a.x*s,y:r.y*s+a.y-a.y*s};return o({scale:s,translate:m,dragStart:this.dragStart,dragMove:this.dragMove,dragEnd:this.dragEnd,zoomIn:this.zoomIn,zoomOut:this.zoomOut,zoomScroll:this.zoomScroll,setZoom:this.setZoom,reset:this.reset,center:this.center})}}M.__docgenInfo={description:"",methods:[{name:"reset",docblock:null,modifiers:[],params:[],returns:null},{name:"center",docblock:null,modifiers:[],params:[],returns:null},{name:"zoomIn",docblock:null,modifiers:[],params:[],returns:null},{name:"zoomOut",docblock:null,modifiers:[],params:[],returns:null},{name:"zoomScroll",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"setZoom",docblock:null,modifiers:[],params:[{name:"scale",optional:!1,type:null}],returns:null},{name:"dragStart",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null},{name:"dragEnd",docblock:null,modifiers:[],params:[],returns:null},{name:"dragMove",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:null}],returns:null}],displayName:"PanZoom"};const et=300,nt=600,P=.1,w=10;function Z(t){const e=D(),n=g.useRef(),[o,r]=g.useState(!1);function s(){r(a=>!a)}return i.jsx(M,{svg:()=>n.current,minZoom:P,maxZoom:w,width:et,height:nt,children:({translate:a,scale:m,dragStart:j,dragMove:z,dragEnd:I,zoomIn:f,zoomOut:T,zoomScroll:R,setZoom:_,center:G,reset:O})=>i.jsxs("div",{className:"pipeline-graph-zoom-container",children:[i.jsx("svg",{width:"100%",height:"100%",ref:n,onWheel:R,...o?{onMouseDown:j,onMouseUp:I,onMouseMove:z}:null,onDoubleClick:f,children:i.jsx("g",{draggable:!0,transform:`translate(${a.x},${a.y}) scale(${m},${m})`,children:i.jsx(V,{...t})})}),i.jsxs("div",{className:"toolbar",children:[i.jsx(c,{disabled:!o,iconDescription:e.formatMessage({id:"dashboard.graph.select",defaultMessage:"Select"}),kind:"ghost",onClick:s,renderIcon:l=>i.jsx(Y,{size:20,...l})}),i.jsx(c,{disabled:o,iconDescription:e.formatMessage({id:"dashboard.graph.pan",defaultMessage:"Pan"}),kind:"ghost",onClick:s,renderIcon:l=>i.jsx(F,{size:20,...l})}),i.jsx(c,{kind:"ghost",onClick:O,children:"Reset"}),i.jsx(c,{kind:"ghost",onClick:G,children:"Center"}),i.jsx(c,{disabled:!1,hasIconOnly:!0,iconDescription:e.formatMessage({id:"dashboard.graph.zoomOut",defaultMessage:"Zoom out"}),kind:"ghost",onClick:T,renderIcon:l=>i.jsx(L,{size:20,...l}),tooltipPosition:"top",tooltipAlignment:"end"}),i.jsx("input",{type:"range",min:P,max:w,value:m,step:".1",onChange:l=>_(l.target.value)}),i.jsx(c,{disabled:!1,hasIconOnly:!0,iconDescription:e.formatMessage({id:"dashboard.graph.zoomIn",defaultMessage:"Zoom in"}),kind:"ghost",onClick:f,renderIcon:l=>i.jsx(X,{size:20,...l}),tooltipPosition:"top",tooltipAlignment:"end"})]})]})})}Z.__docgenInfo={description:"",methods:[],displayName:"ZoomablePipelineGraph"};const Mt={title:"legacy/ZoomablePipelineGraph"},d=()=>i.jsx(Z,{onClickStep:x("onClickStep"),onClickTask:x("onClickTask"),pipeline:A,pipelineRun:$,taskRuns:B,tasks:N});d.__docgenInfo={description:"",methods:[],displayName:"Default"};d.parameters={...d.parameters,docs:{...d.parameters?.docs,source:{originalSource:"() => <ZoomablePipelineGraph onClickStep={action('onClickStep')} onClickTask={action('onClickTask')} pipeline={pipeline} pipelineRun={pipelineRun} taskRuns={taskRuns} tasks={tasks} />",...d.parameters?.docs?.source}}};const Zt=["Default"];export{d as Default,Zt as __namedExportsOrder,Mt as default};
